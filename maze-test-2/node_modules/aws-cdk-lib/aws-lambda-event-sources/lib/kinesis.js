"use strict";var _a,_b;Object.defineProperty(exports,"__esModule",{value:!0}),exports.KinesisConsumerEventSource=exports.KinesisEventSource=void 0;var jsiiDeprecationWarnings=()=>{var tmp=require("../../.warnings.jsii.js");return jsiiDeprecationWarnings=()=>tmp,tmp};const JSII_RTTI_SYMBOL_1=Symbol.for("jsii.rtti");var stream_1=()=>{var tmp=require("./stream");return stream_1=()=>tmp,tmp},cdk=()=>{var tmp=require("../../core");return cdk=()=>tmp,tmp};class KinesisEventSourceBase extends stream_1().StreamEventSource{constructor(source,props){super(props),this.source=source,this._eventSourceMappingId=void 0,this._eventSourceMappingArn=void 0,this.startingPositionTimestamp=props.startingPositionTimestamp,this.props.batchSize!==void 0&&cdk().withResolved(this.props.batchSize,batchSize=>{if(batchSize<1||batchSize>1e4)throw new Error(`Maximum batch size must be between 1 and 10000 inclusive (given ${this.props.batchSize})`)})}bind(target){const eventSourceMapping=target.addEventSourceMapping(`${this.source.eventSourceName}:${cdk().Names.nodeUniqueId(this.source.node)}`,this.enrichMappingOptions({eventSourceArn:this.source.sourceArn,startingPositionTimestamp:this.startingPositionTimestamp,metricsConfig:this.props.metricsConfig,supportS3OnFailureDestination:!0}));this._eventSourceMappingId=eventSourceMapping.eventSourceMappingId,this._eventSourceMappingArn=eventSourceMapping.eventSourceMappingArn,this.source.grantRead(target)}get eventSourceMappingId(){if(!this._eventSourceMappingId)throw new Error(`${this.source.eventSourceName} is not yet bound to an event source mapping`);return this._eventSourceMappingId}get eventSourceMappingArn(){if(!this._eventSourceMappingArn)throw new Error(`${this.source.eventSourceName} is not yet bound to an event source mapping`);return this._eventSourceMappingArn}}class KinesisEventSource extends KinesisEventSourceBase{constructor(stream,props){super({...stream,eventSourceName:"KinesisEventSource",sourceArn:stream.streamArn,grantRead:stream.grantRead.bind(stream)},props),this.stream=stream;try{jsiiDeprecationWarnings().aws_cdk_lib_aws_kinesis_IStream(stream),jsiiDeprecationWarnings().aws_cdk_lib_aws_lambda_event_sources_KinesisEventSourceProps(props)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,KinesisEventSource),error}}}exports.KinesisEventSource=KinesisEventSource,_a=JSII_RTTI_SYMBOL_1,KinesisEventSource[_a]={fqn:"aws-cdk-lib.aws_lambda_event_sources.KinesisEventSource",version:"2.197.0"};class KinesisConsumerEventSource extends KinesisEventSourceBase{constructor(streamConsumer,props){super({...streamConsumer,eventSourceName:"KinesisConsumerEventSource",sourceArn:streamConsumer.streamConsumerArn,grantRead:streamConsumer.grantRead.bind(streamConsumer)},props),this.streamConsumer=streamConsumer;try{jsiiDeprecationWarnings().aws_cdk_lib_aws_kinesis_IStreamConsumer(streamConsumer),jsiiDeprecationWarnings().aws_cdk_lib_aws_lambda_event_sources_KinesisEventSourceProps(props)}catch(error){throw process.env.JSII_DEBUG!=="1"&&error.name==="DeprecationError"&&Error.captureStackTrace(error,KinesisConsumerEventSource),error}}}exports.KinesisConsumerEventSource=KinesisConsumerEventSource,_b=JSII_RTTI_SYMBOL_1,KinesisConsumerEventSource[_b]={fqn:"aws-cdk-lib.aws_lambda_event_sources.KinesisConsumerEventSource",version:"2.197.0"};
